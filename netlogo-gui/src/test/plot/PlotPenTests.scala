// (C) Uri Wilensky. https://github.com/NetLogo/NetLogo

package org.nlogo.plot

class PlotPenTests extends SimplePlotTest {

  test("PlotModeConstants") {
    assert(PlotPen.isValidPlotPenMode(PlotPen.LINE_MODE))
    assert(PlotPen.isValidPlotPenMode(PlotPen.BAR_MODE))
    assert(PlotPen.isValidPlotPenMode(PlotPen.POINT_MODE))
    assert(!PlotPen.isValidPlotPenMode(-1))
    assert(!PlotPen.isValidPlotPenMode(3))
  }
  testPlot("Constructor") { plot =>
    val pen0 = plot.createPlotPen("test", true)
    assert(pen0.temporary)
    val pen = plot.createPlotPen("test", false)
    assertResult("test")(pen.name)
    assert(!pen.temporary)
    assertResult(java.awt.Color.BLACK.getRGB)(pen.color)
    assert(pen.isDown)
    assertResult(0.0)(pen.x)
    assertResult(PlotPen.LINE_MODE)(pen.mode)
    assertResult(1.0)(pen.interval)
    assertResult(0)(pen.points.size)
    assert(pen.inLegend)
  }
  testPlot("penModeChanged") { plot =>
    val pen = plot.createPlotPen("test", true)
    assert(!pen.penModeChanged)
    pen.mode = pen.mode
    assert(!pen.penModeChanged)
    pen.mode = PlotPen.BAR_MODE
    assert(pen.penModeChanged)
    pen.mode = PlotPen.BAR_MODE
    assert(pen.penModeChanged)
    pen.penModeChanged = false
    assert(!pen.penModeChanged)
    pen.mode = PlotPen.BAR_MODE
    assert(!pen.penModeChanged)
    pen.mode = PlotPen.LINE_MODE
    assert(pen.penModeChanged)
  }
  testPlot("ResetOfPermanentPen") { plot =>
    val pen = plot.createPlotPen("test", false)
    assertResult(0.0)(pen.x)
    pen.plot(100)
    pen.plot(200)
    assertResult(1.0)(pen.x)
    pen.isDown = false
    assert(!pen.isDown)
    pen.plot(12.3)
    assertResult(3)(pen.points.size)
    pen.color = java.awt.Color.GREEN.getRGB
    pen.mode = PlotPen.BAR_MODE
    pen.softReset()
    assert(pen.isDown)
    assertResult(0.0)(pen.x)
    assertResult(0)(pen.points.size)
    assertResult(java.awt.Color.GREEN.getRGB)(pen.color)
    assertResult(PlotPen.BAR_MODE)(pen.mode)
    pen.hardReset()
    assertResult(java.awt.Color.BLACK.getRGB)(pen.color)
    assertResult(PlotPen.LINE_MODE)(pen.mode)
  }
  testPlot("ResetOfTemporaryPen") { plot =>
    val pen = plot.createPlotPen("test", true)
    assertResult(0.0)(pen.x)
    pen.plot(100)
    pen.plot(200)
    assertResult(1.0)(pen.x)
    pen.isDown = false
    assert(!pen.isDown)
    pen.plot(12.3)
    assertResult(3)(pen.points.size)
    pen.color = java.awt.Color.GREEN.getRGB
    pen.mode = PlotPen.BAR_MODE
    pen.softReset()
    assert(pen.isDown)
    assertResult(0.0)(pen.x)
    assertResult(0)(pen.points.size)
    assertResult(java.awt.Color.GREEN.getRGB)(pen.color)
    assertResult(PlotPen.BAR_MODE)(pen.mode)
    pen.hardReset()
    assertResult(java.awt.Color.GREEN.getRGB)(pen.color)
    assertResult(PlotPen.BAR_MODE)(pen.mode)
  }
  testPlot("PlotOfOneArg") { plot =>
    val pen = plot.createPlotPen("test", true)
    pen.interval = 1.5
    pen.plot(5.0)
    assertResult(0.0)(pen.x)
    pen.plot(7.5)
    pen.interval = 2.5
    pen.plot(9.0)
    assertResult(3)(pen.points.size)
    assertResult(0.0)(pen.points(0).x)
    assertResult(1.5)(pen.points(1).x)
    assertResult(4.0)(pen.points(2).x)
    assertResult(5.0)(pen.points(0).y)
    assertResult(7.5)(pen.points(1).y)
    assertResult(9.0)(pen.points(2).y)
    assertResult(4.0)(pen.x)
  }
  testPlot("PlotOfTwoArgs") { plot =>
    val pen = plot.createPlotPen("test", true)
    pen.color = java.awt.Color.GREEN.getRGB
    assertResult(0.0)(pen.x)
    pen.plot(1.5, 2.5)
    assertResult(1.5)(pen.x)
    pen.isDown = false
    pen.color = java.awt.Color.RED.getRGB
    pen.plot(3.5, 4.5)
    assertResult(3.5)(pen.x)
    assertResult(2)(pen.points.size)
    assertResult(1.5)(pen.points(0).x)
    assertResult(3.5)(pen.points(1).x)
    assertResult(2.5)(pen.points(0).y)
    assertResult(4.5)(pen.points(1).y)
    assert(pen.points(0).isDown)
    assert(!pen.points(1).isDown)
    assertResult(java.awt.Color.GREEN.getRGB)(pen.points(0).color)
    assertResult(java.awt.Color.RED.getRGB)(pen.points(1).color)
  }
}
